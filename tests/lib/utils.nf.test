
nextflow_function {

    name "Test Functions"
    script "lib/utils.nf"

	

    test("Test Function get_key_list") {

        function "get_key_list"

        when {
            function {
                """
                // define inputs of the function here. Example:
                input[0] = [ "Key1": "value1", "key2": "value2"]
 
                """
            }
        }

        then {
            assert function.success
            assert snapshot(function.result).match()
        }

    }
    test("Test Function read_json") {

        function "read_json"

        when {
            function {
                """
                // define inputs of the function here. Example:
                def temp = File.createTempFile('temp', '.json') 
                temp.write('{"Key": "value"}')  
                input[0] = temp.absolutePath
                """
            }
        }

        then {
            assert function.success
            assert snapshot(function.result).match()
        }

    }
    test("Test Function parse_list_param") {

        function "parse_list_param"

        when {
            function {
                """
                // define inputs of the function here. Example:
                input = tuple("test", ["test", "lorem"])
                """
            }
        }

        then {
            assert function.success
            assert snapshot(function.result).match()
        }

    }
    test("Failure parse_map_param value not in allowed allowed_values ") {

        function  "parse_list_param"

        when {
            function {
                """
                // define inputs of the function here. Example:
                input = tuple("test", ["No_test", "lorem"])
                """
            }
        }

        then {
            assert function.failed
            assert snapshot(function.result).match()
        }

    }
    test("Parse_map_param with no value ") {

        function  "parse_list_param"

        when {
            function {
                """
                // define inputs of the function here. Example:
                input[1] = ["test", "lorem"]
                """
            }
        }

        then {
            assert function.success
            assert snapshot(function.result).match()
        }

    }
    test("Parse_map_param with run all") {

        function  "parse_list_param"

        when {
            function {
                """
                // define inputs of the function here. Example:
                input = tuple("test", ["test", "lorem"], true)
                """
            }
        }

        then {
            assert function.success
            assert snapshot(function.result).match()
        }

    }
    test("Test Function generate_url") {

        function "generate_url"

        when {
            function {
                """
                // define inputs of the function here. Example:
                input = tuple("https", "mysql", 000, "ensro")
                """
            }
        }

        then {
            assert function.success
            assert snapshot(function.result).match()
        }

    }
    test("Test Function extract_url_args") {

        function "extract_url_args"

        when {
            function {
                """
                // define inputs of the function here. Example:
                input[0] = "mysql://ensro@mysql-eg-test-prod:0000/"
                """
            }
        }

        then {
            assert function.success
            assert snapshot(function.result).match()
        }

    }
	
}